<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Installing CDC for Cassandra :: DataStax CDC for Apache Cassandra documentation</title>
    <link rel="canonical" href="http://docs.datastax.com/en/cdc-for-cassandra/cdc-apache-cassandra/1.0.0/install.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../assets/css/site.css">
    <link rel="icon" href="https://www.datastax.com/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a href="http://docs.datastax.com/en/cdc-for-cassandra">
        <img width="223px" height="43px" src="../../assets/img/logo.svg"/>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-end__group">
          <a class="navbar-item" href="/en/landing_page/doc/landing_page/current.html">Docs</a>
          <!--<a class="navbar-item" href="/community">Community</a>-->
          <!--<a class="navbar-item" href="/blog">Blog</a>-->
          <!-- <a class="navbar-item search" href="/results">
            <img width="34px" height="34px" src="../../assets/img/search.svg"/>
          </a>-->
        </div>
        <div class="navbar-end__group">
          <!--<a class="navbar-item social-icon" href="https://twitter.com/stargateio" target="_blank" rel="noopener noreferrer">
            <img width="34px" height="34px" src="../../assets/img/twitter.svg"/>
          </a>-->
          <!--<a class="navbar-item social-icon" href="https://groups.google.com/a/lists.stargate.io/g/stargate-users" target="_blank">
            <img width="34px" height="34px" src="../../assets/img/groups.svg"/>
          </a>-->
          <!--<a class="navbar-item social-icon" href="https://github.com/riptano/pulsar-distro" target="_blank" rel="noopener noreferrer">
            <img width="34px" height="34px" src="../../assets/img/github.svg"/>
          </a>-->
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="cdc-apache-cassandra" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">DataStax CDC for Apache Cassandra(R) Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item toggler" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">About CDC for Cassandra</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="install.html">Installing CDC for Cassandra</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="monitor.html">Monitor CDC for Cassandra</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="faqs.html">CDC for Cassandra FAQs</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">DataStax CDC for Apache Cassandra(R) Documentation</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">DataStax CDC for Apache Cassandra(R) Documentation</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">DataStax CDC for Apache Cassandra(R) Documentation</a></li>
    <li><a href="install.html">Installing CDC for Cassandra</a></li>
  </ul>
</nav>
  <!--<div class="edit-this-page"><a href="https://github.com/datastax/cdc-for-cassandra/blob/master/docs/docs/modules/ROOT/pages/install.adoc">Edit this Page</a></div>-->
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Installing CDC for Cassandra</h1>
<div class="sect1">
<h2 id="_download_the_datastax_change_agent_for_apache_cassandra"><a class="anchor" href="#_download_the_datastax_change_agent_for_apache_cassandra"></a>Download the DataStax Change Agent for Apache Cassandra®</h2>
<div class="sectionbody">
<div class="paragraph">
<p>IMPORTANT</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>By downloading this DataStax product, you agree to the terms of the open-source <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache-2.0 license agreement</a>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Perform the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the change agent tar file from the <a href="https://downloads.datastax.com/#cassandra-change-agent">DataStax downloads page</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following files are available in the tar file:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Cassandra type</th>
<th class="tableblock halign-left valign-top">Streaming platform</th>
<th class="tableblock halign-left valign-top">JAR file</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache Cassandra 3.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache Pulsar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">agent-c3-pulsar-&lt;version&gt;-all.jar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache Cassandra 3.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luna Streaming</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">agent-c3-luna-&lt;version&gt;-all.jar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache Cassandra 4.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache Pulsar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">agent-c4-pulsar-&lt;version&gt;-all.jar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache Cassandra 4.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luna Streaming</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">agent-c4-luna-&lt;version&gt;-all.jar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSE 6.8.16+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache Pulsar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">agent-dse4-pulsar-&lt;version&gt;-all.jar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSE 6.8.16+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luna Streaming</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">agent-dse4-luna-&lt;version&gt;-all.jar</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Extract the files from the tar with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-language-bash hljs" data-lang="language-bash">tar xvf cassandra-source-agents-&lt;version&gt;.tar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the file that matches your Cassandra type and streaming platform.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_start_cassandra_with_the_change_agent_for_cassandra"><a class="anchor" href="#_start_cassandra_with_the_change_agent_for_cassandra"></a>Start Cassandra with the Change Agent for Cassandra</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All data nodes of your Cassandra or DSE datacenter must run the change agent as a JVM agent to send mutations into the events topic of your streaming software.
Start your Cassandra or DSE nodes with the appropriate producer binary matching your Cassandra (3.11 or 4.0) or DSE (6.8.16) version and your streaming platform (Luna Streaming or Apache Pulsar).</p>
</div>
<div class="paragraph">
<p>As a Java agent, the change agent parameters take place after the <code>jar</code> file name in the form of a comma-separated list of <code>paramName=paramValue</code>.
Here is an example for Luna Streaming/Apache Pulsar on Cassandra version 4.0 nodes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-language-bash hljs" data-lang="language-bash">export JVM_EXTRA_OPTS="-javaagent:/path/to/agent-c4-luna-&lt;version&gt;-all.jar=pulsarServiceUrl=pulsar://pulsar:6650"</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the full set of configuration options, see <a href="agentParams.html" class="page">Change Agent Parameters</a></p>
</div>
<div class="paragraph">
<p>In addition to configuring the change agent, enable CDC on the Cassandra node by setting <code>cdc_enabled</code> to <code>true</code> in the <code>cassandra.yaml</code> file.</p>
</div>
<div class="paragraph">
<p>For Cassandra 4.X and DSE 6.8.16+, you can configure the commit log sync period.
This parameter controls how often the commit logs are made available for CDC processing.
The default is 10 seconds.
To reduce the latency from when the table is updated to when the event is available in the data topic, decrease the period, such as 2 seconds.</p>
</div>
<div class="paragraph">
<p>The total amount of CDC data stored is controlled by the <code>cdc_total_space_in_mb</code> parameter.
If the amount of unprocessed CDC reaches this threshold, writes to CDC enabled tables will be rejected.
Make sure you have the change agent installed on the node when CDC is enabled.
Without the change agent to process the CDC data, the space used will grow until it hits this limit and then writes to CDC-enabled tables will stop.</p>
</div>
<div class="paragraph">
<p>Here is an example set of configurations for the <code>cassandra.yaml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-language-bash hljs" data-lang="language-bash">cdc_enabled: true
commitlog_sync_period_in_ms: 2000
cdc_total_space_in_mb: 50000</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_change_agent_parameters"><a class="anchor" href="#_change_agent_parameters"></a>Change Agent Parameters</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Table Change Agent Parameters</caption>
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 42.8571%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>topicPrefix</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The event topic name prefix. The &lt;keyspace_name&gt;.&lt;table_name&gt; is appended to that prefix to build the topic name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">events-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cdcWorkingDir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CDC working directory where the last sent offset is saved, and where the archived and errored commitlogs files are copied.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cdc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cdcPoolIntervalMs</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pool interval in milliseconds for watching new commit log files in the CDC raw directory.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>errorCommitLogReprocessEnabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable the re-processing of error commit logs files.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cdcConcurrentProcessors</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of threads used to process commitlog files. The default value is the memtable_flush_writers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>maxInflightMessagesPerTask</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of in-flight messages per commitlog processing task.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16384</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pulsarServiceUrl</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Pulsar broker service URL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pulsar://localhost:6650</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pulsarBatchDelayInMs</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pulsar batching delay in milliseconds. Pulsar batching is enabled when this value is greater than zero.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pulsarKeyBasedBatcher</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When true, use the Pulsar KEY_BASED BatchBuilder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pulsarMaxPendingMessages</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Pulsar maximum size of a queue holding pending messages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pulsarMaxPendingMessagesAcrossPartitions</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Pulsar maximum number of pending messages across partitions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pulsarAuthPluginClassName</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Pulsar authentication plugin class name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pulsarAuthParams</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Pulsar authentication parameters.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslProvider</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The SSL/TLS provider to use.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslTruststorePath</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path to the SSL/TLS truststore file.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslTruststorePassword</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password for the SSL/TLS truststore.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslTruststoreType</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the SSL/TLS truststore.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JKS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslKeystorePath</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path to the SSL/TLS keystore file.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslKeystorePassword</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password for the SSL/TLS keystore.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslCipherSuites</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines one or more cipher suites to use for negotiating the SSL/TLS connection.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslEnabledProtocols</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled SSL/TLS protocols</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLSv1.2,TLSv1.1,TLSv1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslAllowInsecureConnection</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows insecure connections to servers whose cert has not been signed by an approved CA. You should always disable sslAllowInsecureConnection in production environments.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sslHostnameVerificationEnable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable the server hostname verification.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_download_csc_for_pulsar"><a class="anchor" href="#_download_csc_for_pulsar"></a>Download CSC for Pulsar</h2>
<div class="sectionbody">
<div class="paragraph">
<p>IMPORTANT</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>By downloading this DataStax product, you agree to the terms of the open-source <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache-2.0 license agreement</a>.</p>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the <code>pulsar-cassandra-source-&lt;version&gt;.tar</code> file from the <a href="https://downloads.datastax.com/#cassandra-source-connector">DataStax downloads page</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following files are available:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Streaming platform</th>
<th class="tableblock halign-left valign-top">NAR file</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache Pulsar 2.8 and Luna Streaming 2.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pulsar-cassandra-source-&lt;version&gt;.nar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luna Streaming 2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">luna-cassandra-source-&lt;version&gt;.nar</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Extract the files from the tar with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-language-bash hljs" data-lang="language-bash">tar xvf cassandra-source-connectors-&lt;version&gt;.tar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the version that matches your streaming platform.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploy_csc_for_pulsar"><a class="anchor" href="#_deploy_csc_for_pulsar"></a>Deploy CSC for Pulsar</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To deploy the CSC for Pulsar <code>NAR</code> file in your Pulsar cluster, upload it to Luna Streaming or Pulsar using the <code>pulsar-admin sources create</code> command.
You need to deploy a CSC for Pulsar for each CDC-enabled table.</p>
</div>
<div class="paragraph">
<p>For each CDC-enabled table, the change agent will send events to the events topic.
The topic name is determined by the <code>topicPrefix</code> setting in the agent (default is <code>events-</code>).
The <code>&lt;keyspace_name&gt;.&lt;table_name&gt;</code> is appended to the prefix to build the topic name.</p>
</div>
<div class="paragraph">
<p>You have to specify the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Connector name. You have one connector per CDC-enabled Cassandra table, make sure to use a unique name.</p>
</li>
<li>
<p>Previously downloaded CSC for Pulsar <code>NAR</code> file.</p>
</li>
<li>
<p>Pulsar <code>tenant</code> and <code>namespace</code> where the connector will run.</p>
</li>
<li>
<p>Destination <code>topic</code> for Cassandra data (<code>data</code> topic).</p>
</li>
<li>
<p>Number of instances (parallelism) of the connector. For high-volume tables, you might need to run multiple connector instances to prevent a growing backlog on the events topic.</p>
</li>
<li>
<p>Name of the <code>events</code> topic the connector will read from.</p>
</li>
<li>
<p>Keyspace and table associated with the events topics.</p>
</li>
<li>
<p>Connection information (such as contact points and DC information) for Cassandra.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-language-bash hljs" data-lang="language-bash">pulsar-admin source create \
--name cassandra-source-1 \
--archive /path/to/pulsar-cassandra-source-&lt;version&gt;.nar \
--tenant public \
--namespace default \
--destination-topic-name public/default/data-ks1.table1 \
--parallelism 1 \
--source-config '{
    "events.topic": "persistent://public/default/events-cdc-ks1.table1",
    "keyspace": "ks1",
    "table": "table1",
    "contactPoints": "localhost",
    "port": 9042
    "loadBalancing.localDc": "DC1",
    "auth.provider": "PLAIN",
    "auth.username": "&lt;username&gt;",
    "auth.password": "&lt;password&gt;",
}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then check your connector is in the running state with no errors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-language-bash hljs" data-lang="language-bash">pulsar-admin source status --name cassandra-source-1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the connector is running, it will process events from the <code>events</code> topic and publish the result to the <code>data</code> topic.</p>
</div>
<div class="paragraph">
<p>For the full set of source configuration options, see <a href="cfgCassandraSource.html" class="page">CSC for Pulsar settings</a>.
For the full set of Cassandra authentication options, see <a href="cfgCassandraAuth.html" class="page">Cassandra Authentication settings</a>.
For the full set of Cassandra SSL settings, see <a href="cfgCassandraSSL.html" class="page">Cassandra SSL/TLS settings</a>.
For advanced configuration of the Cassandra driver in the CSC for Pulsar, see <a href="cfgCassandraJavaDriverSettings.html" class="page">Pass CSC for Pulsar settings directly to the DataStax Java driver</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_enabling_and_disabling_cdc_on_a_table"><a class="anchor" href="#_enabling_and_disabling_cdc_on_a_table"></a>Enabling and disabling CDC on a table</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the change agent is installed and the connector is running, you can enable or disabled CDC on table using the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-language-bash hljs" data-lang="language-bash">CREATE TABLE foo (a int, b text, PRIMARY KEY(a)) WITH cdc=true;
ALTER TABLE foo WITH cdc=true;
ALTER TABLE foo WITH cdc=false;</code></pre>
</div>
</div>
<div class="paragraph">
<p>When CDC is enabled on a table, updates to that table are sent by the change agent to the CSC for Pulsar which further processes the event and then sends it to the data topic when it can be processed by other connectors (for example, Elasticsearch).</p>
</div>
<div class="paragraph">
<p>For the full set of source configuration options, see <a href="cfgCassandraSource.html" class="page">CSC for Pulsar settings</a>.
For the full set of Cassandra authentication options, see <a href="cfgCassandraAuth.html" class="page">Cassandra Authentication settings</a>.
For the full set of Cassandra SSL settings, see <a href="cfgCassandraSSL.html" class="page">Cassandra SSL/TLS settings</a>.
For advanced configuration of the Cassandra driver in the CSC for Pulsar, see <a href="cfgCassandraJavaDriverSettings.html" class="page">Pass CSC for Pulsar settings directly to the DataStax Java driver</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scaling_up_your_configuration"><a class="anchor" href="#_scaling_up_your_configuration"></a>Scaling up your configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If your connector is not keeping up and the messages in the events topic are growing, increase the number of connector instances using the <code>parallelism</code> parameter.
Pulsar ensures in-order processing using Key_Shared subscriptions.</p>
</div>
<div class="paragraph">
<p>If the volume of data in the events topic is very high, <a href="https://pulsar.apache.org/docs/en/admin-api-topics/#manage-partitioned-topics">partition</a> the events topic to distribute the load across multiple Pulsar brokers.
Do this before starting the change agent, since by default Puslar will auto-create non-partitioned topics.
If you are using partitioned topics, change <code>events.subscription.type</code> to <code>Failover</code> to ensure in-order delivery when running multiple connector instances.</p>
</div>
<div class="paragraph">
<p>To further improve the throughput, you can adjust the <code>pulsarBatchDelayInMs</code> in the change agent to batch messages in the change agent before sending them to Pulsar.</p>
</div>
<div class="paragraph">
<p>To improve performance on individual connector instances as they read data from Cassandra, you can adjust the <code>batch.size</code> and the <code>query.executors</code>.
Increasing these values from their defaults will increase parallelism within the connector instances.</p>
</div>
<div class="paragraph">
<p>The de-duplication cache is configurable, including the cache size with <code>cache.max.capacity</code>, the entry retention duration <code>cache.expire.after.ms</code> and the number of MD5 digest per primary key entry with <code>cache.max.digest</code>.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main></div>
<footer class="footer">
  <div class="footer-row">
    <div class="footer__notice align-items-center row">
      <div class="order-1 order-lg-0 col-lg col-12">
        <p class="small mb-0">
          © 2021 DataStax |
          <a href="https://www.datastax.com/legal/datastax-website-privacy-policy">Privacy Policy</a> |
          <a href="https://www.datastax.com/legal/datastax-website-terms-use">Terms of Use</a>
              <!-- UNCOMMENT IF USING ONETRUST FOR COOKIES
                <span><a href="#" id="ot-sdk-btn" class="ot-sdk-show-settings">Do Not Sell My Personal Information</a></span>
              -->
        </p>
      </div>
    <div class="text-center text-lg-left mb-5 mb-lg-0 col-lg-auto col-12">
        <a class="ml-1" href="https://www.facebook.com/datastax" target="_blank" rel="noreferrer"><img
            src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTMyIDBIMHYzMS42NWgxNy4wOTVWMTkuNDM2aC00LjE4MlYxNC42Mmg0LjE2di0zLjUxNWMwLTQuMDkzIDIuNTItNi4zMiA2LjIwOS02LjMyYTM1LjI3IDM1LjI3IDAgMDEzLjc1LjIxMnY0LjI3aC0yLjU0OWMtMi4wMDQgMC0yLjM5MS45MzgtMi4zOTEgMi4zMnYzLjA1NWg0LjhsLS42MjMgNC43OTJoLTQuMTc3VjMxLjY1SDMyVjB6IiBmaWxsPSIjMUU3MUQ0Ii8+PC9zdmc+"
            alt="Facebook logo" loading="lazy"></a>
        <a class="ml-1" href="https://twitter.com/datastax" target="_blank" rel="noreferrer"><img
            src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTMyLjAwMSAzMS42NWgtMzJWMGgzMnYzMS42NXptLTE5LjcxMi03Ljc4NWM3LjU0NCAwIDExLjY3Mi02LjE4OCAxMS42NzItMTEuNTQ1IDAtLjE3NCAwLS4zNDgtLjAwOC0uNTIyLjgtLjU3IDEuNDk2LTEuMjkgMi4wNDgtMi4xMDVhOC4zODcgOC4zODcgMCAwMS0yLjM2LjY0MSA0LjA5IDQuMDkgMCAwMDEuODA4LTIuMjQ3IDguMjExIDguMjExIDAgMDEtMi42MDguOTgxIDQuMTE2IDQuMTE2IDAgMDAtMi45OTItMS4yODJjLTIuMjY0IDAtNC4xMDQgMS44Mi00LjEwNCA0LjA2IDAgLjMxNi4wNC42MjQuMTA0LjkyNUExMS42OTIgMTEuNjkyIDAgMDE3LjM5MyA4LjUzYTQuMDI0IDQuMDI0IDAgMDAtLjU1MiAyLjA0MSA0LjA2IDQuMDYgMCAwMDEuODI0IDMuMzggNC4xODQgNC4xODQgMCAwMS0xLjg1Ni0uNTA3di4wNTVjMCAxLjk2MiAxLjQxNiAzLjYwOCAzLjI4OCAzLjk4YTQuMDQgNC4wNCAwIDAxLTEuMDguMTQzYy0uMjY0IDAtLjUyLS4wMjQtLjc2OC0uMDcyYTQuMDk3IDQuMDk3IDAgMDAzLjgzMiAyLjgxNyA4LjI4NSA4LjI4NSAwIDAxLTUuMDk2IDEuNzQxYy0uMzI4IDAtLjY1Ni0uMDE2LS45NzYtLjA1NWExMS43NjMgMTEuNzYzIDAgMDA2LjI4IDEuODEyeiIgZmlsbD0iIzFFNzFENCIvPjwvc3ZnPg=="
            alt="Twitter logo" loading="lazy"></a>
        <a class="ml-1" href="https://www.linkedin.com/company/datastax/" target="_blank" rel="noreferrer"><img
            src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTS4wMDEgMHYzMS42NWgzMlYwaC0zMnptOS40ODEgMjYuOTYyaC00Ljc0VjExLjg0aDQuNzR2MTUuMTIyek03LjExMiA5Ljc4OGEyLjcwNCAyLjcwNCAwIDAxLTIuNzI2LTIuNjk2YzAtMS41MjQgMS4yNDUtMi42OTYgMi43MjYtMi42OTYgMS41NCAwIDIuNzI2IDEuMjMgMi43MjYgMi42OTYuMDYgMS40NjUtMS4xODUgMi42OTYtMi43MjYgMi42OTZ6TTI3LjI2IDI2Ljk2MmgtNC43NHYtNy4zMjdjMC0xLjc1OC0uMDYtMy45ODUtMi40OS0zLjk4NS0yLjQ4OCAwLTIuODQ0IDEuOTM0LTIuODQ0IDMuODY4djcuNDQ0aC00Ljc0VjExLjg0aDQuNTYydjIuMDUxaC4wNmMuNjUxLTEuMTcyIDIuMTkyLTIuNDYxIDQuNTAzLTIuNDYxIDQuOCAwIDUuNjkgMy4xMDYgNS42OSA3LjIwOXY4LjMyM3oiIGZpbGw9IiMxRTcxRDQiLz48L3N2Zz4="
            alt="LinkedIn logo" loading="lazy"></a>
        <a class="ml-1" href="https://github.com/datastax/" target="_blank" rel="noreferrer"><img
            src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zMiAwSDB2MzEuNjVoMzJWMHpNNCAxNS44MDVDNCA5LjI4NyA5LjM1OCA0IDE1Ljk2MyA0IDIyLjU3IDQgMjcuOTI3IDkuMjg3IDI4IDE1LjgwNWMwIDUuMjE1LTMuMzc2IDkuNjMyLTguMTQ3IDExLjIyNi0uNTg3LjA3Mi0uODA3LS4yOS0uODA3LS41OHYtMy4yNTljMC0xLjA4Ni0uMzY3LTEuODEtLjgwOC0yLjE3MiAyLjY0My0uMjkgNS40MzItMS4yMzIgNS40MzItNS43OTRhNC42NSA0LjY1IDAgMDAtMS4yNDgtMy4xODdsLjAyMy0uMDg1YTQuNDQgNC40NCAwIDAwLS4xNy0zLjAzcy0xLjAyNy0uMjg5LTMuMzAyIDEuMjMyYTEzLjY4MSAxMy42ODEgMCAwMC0zLjAxLS4zNjJjLTEuMDI3IDAtMi4wNTUuMDcyLTMuMDA5LjM2Mi0yLjI3NS0xLjUyLTMuMzAzLTEuMjMxLTMuMzAzLTEuMjMxLS42NDggMS41NjQtLjIzNSAyLjc4LS4xNSAzLjAyOSAwIC4wMDQuMDAyLjAwOS4wMDQuMDEzLS44MDguODY5LTEuMjQ4IDEuODgzLTEuMjQ4IDMuMTg2IDAgNC41NjMgMi43ODkgNS41NzcgNS40MzEgNS44NjctLjI5My4yOS0uNjYuNzk2LS43MzQgMS41OTMtLjY2LjI5LTIuMzQ5Ljc5Ny0zLjQ1LTEuMDE0IDAgMC0uNjYtMS4xNTktMS44MzQtMS4yMzEgMCAwLTEuMTc1IDAtLjA3NC43MjQgMCAwIC44MDguMzYyIDEuMzIxIDEuNzM4IDAgMCAuNzM0IDIuMzE4IDQuMDM3IDEuNTkzdjIuMDI4YzAgLjI5LS4yMi42NTItLjgwNy41OEM3LjQ1IDI1LjQzNyA0IDIxLjAyIDQgMTUuODA1eiIgZmlsbD0iIzFFNzFENCIvPjwvc3ZnPg=="
            alt="GitHub logo" loading="lazy"></a>
    </div>
   </div>
  </div>
</footer>
<script src="../../assets/js/site.js"></script>
<script async src="../../assets/js/vendor/highlight.js"></script>
  </body>
</html>
